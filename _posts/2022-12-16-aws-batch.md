---
layout: post
title: "AWS - Batch"
description: ""
category: posts
tags: [aws, batch, vpc, aws-solutions-arch-pro]
---
{% include JB/setup %}

[Batch](https://aws.amazon.com/batch/) enables batch computing workloads on the AWS Cloud using Docker images.

Can run serverless using Fargate OR dynamic provisioning of EC2 on-demand, or Spot. Can be scheduled by EventBridge and orchestrated using Step Functions. Managed compute environments you set the min/max vCPU and fleet type (on-demand or Spot) and Batch manages the capacity and instances types. Managed environments require the VPC must have access to the ECS and ECR service - NAT/IGW or VPC endpoint work. Unmanaged compute environments require instances configuration, provisioning, scaling and management.

How Managed compute environment works:
0. Set min/max vCPU and fleet type (on-demand or Spot)
0. Batch launches instance that are likely different sizes
0. SDK is used to add Batch Job Queue 
0. Batch Job Queue distributes jobs
0. Autoscaling happens

Multi-node mode is for large scale, HPC types of workloads. There is 1 main node and many child nodes; feels similiar how Hadoop works. Works best with EC2 launch mode is a Cluster placement group; does not work with Spot.

## Lambda vs Batch
|            | Lambda     | Batch                                   |
|------------|------------|-----------------------------------------|
| Timelimit  | 15 minutes | no time limit                           |
| Runtime    | limited    | any runtime                             |
| Disk space | limited    | unlimited (EBS)                         |
| Compute    | Serverless | Serverless or EC2 (on-demand, Spot) |